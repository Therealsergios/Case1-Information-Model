## Описание негативных кейсов
### Кейс 1: Отправка неполных или некорректных данных

Шаги:
 1. Открыть форму создания объекта pipe
 2. Заполнить только часть полей (например, name, tag), оставив пустыми dn, do, length
 3. Нажать «Сохранить»

Ожидаемое поведение:
- Система должна показать валидационные ошибки (подсветка, сообщения)
- Backend не должен принимать неполные данные.
- Нет вызова API до тех пор, пока форма не будет корректно заполнена.

### Кейс 2: Ввод данных в неверном формате

Шаги:

 1. Ввести строку в числовое поле dn, например: dn = "сто" (русским текстом)
 2. Сохранить

Ожидаемое поведение:

- Система не позволяет отправить форму, показывает ошибку валидации
- Backend не принимает запрос, возвращает 400 Bad Request (если форма всё же отправлена)
- Никаких обращений к внешней системе не происходит

### Кейс 3: UUID не найден в Системе 2

Контекст: Пользователь вводит валидные данные, но UUID после генерации отсутствует в ERP системе.

Шаги:

 1. Создать новый объект pipe
 2. Убедиться, что UUID не существует в ERP системе (например, тестовая заглушка на API)
 3. Завершить создание объекта

Ожидаемое поведение:
- Интеграционный сервис получает 200 от /classes/objects, но 0 найденных UUID
- Не происходит обогащения полей
- В карточке объекта система может показать сообщение: “Дополнительные данные недоступны”
- В логах: статус NOT_FOUND, HTTP 200/400

### Кейс 4: Внешняя система (API) недоступна

Контекст: При создании объекта сервис пытается обратиться к внешней системе, но она не отвечает

Шаги:
 1. Создать объект с валидными данными
 2. Во время запроса к внешнему API симулировать сетевую ошибку (отключить соединение)

Ожидаемое поведение:
- Пользовательский объект сохраняется (в базу идут только локальные поля)
- В карточке отображается, что данные не были обогащены
- Лог содержит external_status: 500, статус "FAILED" или "RETRY_PENDING"

### Кейс 5: JWT-токен недействителен или истёк

Контекст: Интеграционный сервис отправляет запрос в ERP или PDM систему с недействительным токеном

Шаги:
 1. Создайть объект как обычно
 2. Использовать поддельный или просроченный JWT

Ожидаемое поведение:
- Запрос к /api/erp-system/... или /api/pdm-system/... завершается с 401 Unauthorized
- Система не выполняет обогащение
- В логах фиксируется ошибка авторизации
- Пользователь видит уведомление: “Ошибка авторизации при подключении к внешней системе”

### Кейс 6: Дубликат tag или name (уникальность нарушена)

Шаги:
 1. Создайте объект pipe с tag = ptp001, name = 001
 2. Снова попробуйте создать объект с теми же значениями

Ожидаемое поведение:
- Система блокирует сохранение
- Пользователю показывается сообщение: “Объект с таким tag уже существует”

### : Кейс 7: Ошибка при сохранении в базу (внутренняя ошибка сервера)

Контекст: После получения всех данных система пытается сделать INSERT, но происходит сбой

Как воспроизвести:
- Подставить некорректный SQL-инъекционный текст в одно из полей
- Временно отключить БД для симуляции 500 Internal Server Error

Ожидаемое поведение:
- Система возвращает 500
- Пользователь получает сообщение “Ошибка сохранения. Обратитесь к администратору”
- В логах фиксируется статус FAILED, internal_status: 500

### Таблица чек-листов негативных кейсов

<table class="cases">
  <thead>
    <tr>
      <th>Кейс</th>
      <th>Статус</th>
      <th>Действие</th>
      <th>Поведение</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>6</td>
      <td>Успешно</td>
      <td>создание объекта с существующим "tag"</td>
      <td>Ошибка - "Объект с таким "tag" уже существует"</td>
    </tr>
  </tbody>
</table>
<style>
  .cases {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
  }
  .cases th, .cases td {
    border: 1px solid #000;
    padding: 6px 8px;
    vertical-align: top;
    word-wrap: break-word;
  }
  .cases th {
    font-weight: 700;
    text-align: left;
  }
</style>